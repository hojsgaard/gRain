<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Graphical Independence Networks • gRain</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Graphical Independence Networks">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gRain</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.1.9012</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/grain.html">Graphical Independence Networks</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Graphical Independence Networks</h1>
            <h3 data-toc-skip class="subtitle">A vignette for the gRain
package</h3>
                        <h4 data-toc-skip class="author">Søren
Højsgaard</h4>
            
      

      <div class="hidden name"><code>grain.rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="bayesian-networks">Bayesian networks<a class="anchor" aria-label="anchor" href="#bayesian-networks"></a>
</h2>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>The gRain package implements Bayesian Networks (hereafter often
abbreviated BNs). The name gRain is an acronym for [gra]phical
[i]ndependence [n]etworks. The main reference for gRain is <span class="citation">Højsgaard (2012)</span>, see also
<code>citation("gRain")</code>.</p>
<p>Moreover, <span class="citation">Højsgaard, Edwards, and Lauritzen
(2012)</span> gives a broad treatment of graphical models (including
Bayesian networks) More information about the package, other graphical
modelling packages and development versions is available from</p>
<!-- ## Two worked examples {#sec:two-worked-examples} -->
<!-- ### Wet grass {#sec:wet-grass} -->
<!-- The `wet grass` example is motivated by the following narrative (taken from  -->
<!-- (https://en.wikipedia.org/wiki/Bayesian_network)): -->
<!--   *"Two events can cause grass to be wet: an active sprinkler or -->
<!--   rain. Rain has a direct effect on the use of the sprinkler (namely -->
<!--   that when it rains, the sprinkler usually is not active).*" -->
<!-- ```{r echo=F, results='hide'} -->
<!-- yn <- c("yes","no") -->
<!-- p.R    <- cpt(~R, values=c(2, 8), levels=yn) -->
<!-- p.S_R  <- cpt(~S:R, values=c(1, 99, 4, 6), levels=yn) -->
<!-- p.G_SR <- cpt(~G:S:R, values=c(99, 1, 8, 2, 9, 1, 0, 1), levels=yn) -->
<!-- grass_bn <- compile_cpt(p.R, p.S_R, p.G_SR)  %>% grain -->
<!-- ```  -->
<!-- ```{r chest-grass, fig.height=5, echo=F, fig.cap="Wet graph example; taken from Wikipedia."} -->
<!-- par(mar=c(0,0,0,0)) -->
<!-- plot(grass_bn$dag) -->
<!-- ``` -->
<div class="section level4">
<h4 id="sec:chest-clinic">Example: Chest clinic<a class="anchor" aria-label="anchor" href="#sec:chest-clinic"></a>
</h4>
<p>This section reviews the chest clinic example of <span class="citation">Lauritzen and Spiegelhalter (1988)</span> (illustrated
in Figure @ref(fig:chest-LS)) and shows one way of specifying the model
in gRain. <span class="citation">Lauritzen and Spiegelhalter
(1988)</span> motivate the chest clinic example with the following
narrative:</p>
<p><em>``Shortness–of–breath (dyspnoea) may be due to tuberculosis, lung
cancer or bronchitis, or none of them, or more than one of them. A
recent visit to Asia increases the chances of tuberculosis, while
smoking is known to be a risk factor for both lung cancer and
bronchitis. The results of a single chest X–ray do not discriminate
between lung cancer and tuberculosis, as neither does the presence or
absence of dyspnoea.’’</em></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_dag</span> <span class="op">&lt;-</span> <span class="fu">dag</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"asia"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tub"</span>, <span class="st">"asia"</span><span class="op">)</span>, <span class="st">"smoke"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lung"</span>, <span class="st">"smoke"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bronc"</span>, </span>
<span><span class="st">"smoke"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"either"</span>, <span class="st">"tub"</span>, <span class="st">"lung"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"xray"</span>, <span class="st">"either"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dysp"</span>, </span>
<span><span class="st">"bronc"</span>, <span class="st">"either"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">chest_dag</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/grain-unnamed-chunk-4-1.png" width="480"></p>
<div class="figure">
<img src="figures/grain-chest-LS-1.png" alt="Chest clinic example from Lauritzen and Spiegelhalter (1988)." width="480"><p class="caption">
Chest clinic example from Lauritzen and Spiegelhalter (1988).
</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="building-a-bayesian-network">Building a Bayesian network<a class="anchor" aria-label="anchor" href="#building-a-bayesian-network"></a>
</h3>
<p>The description above involves the following binary variables:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mtext mathvariant="normal">asia</mtext></mrow><annotation encoding="application/x-tex">a=\mbox{asia}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mtext mathvariant="normal">smoker</mtext></mrow><annotation encoding="application/x-tex">s=\mbox{smoker}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mtext mathvariant="normal">tuberculosis</mtext></mrow><annotation encoding="application/x-tex">t=\mbox{tuberculosis}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mtext mathvariant="normal">lung cancer</mtext></mrow><annotation encoding="application/x-tex">l=\mbox{lung cancer}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mtext mathvariant="normal">bronchitis</mtext></mrow><annotation encoding="application/x-tex">b=\mbox{bronchitis}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mtext mathvariant="normal">either tuberculosis or lung cancer</mtext></mrow><annotation encoding="application/x-tex">e=\mbox{either tuberculosis or lung cancer}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mtext mathvariant="normal">dyspnoea</mtext></mrow><annotation encoding="application/x-tex">d=\mbox{dyspnoea}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mtext mathvariant="normal">xray</mtext></mrow><annotation encoding="application/x-tex">x=\mbox{xray}</annotation></semantics></math>.</p>
<p>Each variable is binary and can take the values “yes” and “no”: Note
that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>e</mi><annotation encoding="application/x-tex">e</annotation></semantics></math>
is a logical variable which is true (yes) if either
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>
are true (yes) and false (no) otherwise. The connection between the
variables is displayed by the DAG (directed acyclic graph) in
Figure~@ref(fig:chest-LS).</p>
<p>A joint probability density factorizing according to a DAG with nodes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
can be constructed as follows: Each node
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>∈</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">v\in V</annotation></semantics></math>
has a set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">pa(v)</annotation></semantics></math>
of parents and each node
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>∈</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">v\in V</annotation></semantics></math>
has a finite set of states. A joint distribution over the variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
can be given as a product of conditional distributions</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mi>#</mi><mi>e</mi><mi>q</mi><mo>:</mo><mi>d</mi><mi>a</mi><mi>g</mi><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>V</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>∏</mo><mrow><mi>v</mi><mo>∈</mo><mi>V</mi></mrow></munder><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="false" form="prefix">|</mo><mi>p</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  (\#eq:dagfact1)
  p(V) = \prod_{v\in V} p(v|pa(v))
\end{align}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="false" form="prefix">|</mo><mi>p</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(v|pa(v))</annotation></semantics></math>
is a function defined on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo>,</mo><mi>p</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(v,pa(v))</annotation></semantics></math>.
This function satisfies that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>∑</mo><msup><mi>v</mi><mo>*</mo></msup></munder><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo>=</mo><msup><mi>v</mi><mo>*</mo></msup><mo stretchy="false" form="prefix">|</mo><mi>p</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>,</mo></mrow><annotation encoding="application/x-tex">
\sum_{v^*} p(v=v^*|pa(v))=1,
</annotation></semantics></math></p>
<p>i.e. that for each configuration of the parents
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">pa(v)</annotation></semantics></math>,
the sum over the levels of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>
equals one. Hence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="false" form="prefix">|</mo><mi>p</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(v|pa(v))</annotation></semantics></math>
becomes the conditional distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">pa(v)</annotation></semantics></math>.
In practice
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="false" form="prefix">|</mo><mi>p</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(v|pa(v))</annotation></semantics></math>
is specified as a table called a conditional probability table or a CPT
for short. Thus, a Bayesian network can be regarded as a complex
stochastic model built up by putting together simple components
(conditional probability distributions). A joint probability density for
all eight variables in Figure~@ref(fig:chest-LS) can be constructed
as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">(</mo><mi>#</mi><mi>e</mi><mi>q</mi><mo>:</mo><mi>c</mi><mi>h</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>V</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo stretchy="false" form="prefix">|</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="false" form="prefix">|</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>e</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo>,</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="false" form="prefix">|</mo><mi>e</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="prefix">|</mo><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  (\#eq:chestfact1)
  p(V) =
  p(a)p(s)p(t|a)p(l|s)p(b|s)p(e|t,l)
  p(d|e, b)p(x|e).
\end{align}</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="queries-to-networks">Queries to networks<a class="anchor" aria-label="anchor" href="#queries-to-networks"></a>
</h3>
<p>Suppose we are given the evidence (sometimes also called “finding”)
that a set of variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>⊂</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">E\subset V</annotation></semantics></math>
have a specific value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>e</mi><mo>*</mo></msup><annotation encoding="application/x-tex">e^*</annotation></semantics></math>.
With this evidence, we are often interested in the conditional
distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo stretchy="false" form="prefix">|</mo><mi>E</mi><mo>=</mo><msup><mi>e</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(v|E=e^*)</annotation></semantics></math>
for some of the variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>∈</mo><mi>V</mi><mo>\</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">v \in V \setminus E</annotation></semantics></math>
or in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>U</mi><mo stretchy="false" form="prefix">|</mo><mi>E</mi><mo>=</mo><msup><mi>e</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(U|E=e^*)</annotation></semantics></math>
for a set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>⊂</mo><mi>V</mi><mo>\</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">U\subset V \setminus E</annotation></semantics></math>.
Interest might also be in calculating the probability of a specific
event, e.g. the probability of seeing a specific evidence,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mo>=</mo><msup><mi>e</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(E=e^*)</annotation></semantics></math>.
Other types of evidence (called soft evidence, virtual evidence or
likelihood evidence) are discussed in Section @ref(sec:hard-soft).</p>
<p>For example that a person has recently visited Asia and suffers from
dyspnoea,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mtext mathvariant="normal">yes</mtext></mrow><annotation encoding="application/x-tex">a=\mbox{yes}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mtext mathvariant="normal">yes</mtext></mrow><annotation encoding="application/x-tex">d=\mbox{yes}</annotation></semantics></math>.
In the chest clinic example, interest might be in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo stretchy="false" form="prefix">|</mo><msup><mi>e</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(l|e^*)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><msup><mi>e</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(t|e^*)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="false" form="prefix">|</mo><msup><mi>e</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(b|e^*)</annotation></semantics></math>,
or possibly in the joint (conditional) distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>b</mi><mo stretchy="false" form="prefix">|</mo><msup><mi>e</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(l,t,b|e^*)</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="a-oneminute-version-of-grain">A one–minute version of gRain<a class="anchor" aria-label="anchor" href="#a-oneminute-version-of-grain"></a>
</h3>
<div class="section level4">
<h4 id="specifying-a-bayesian-network">Specifying a Bayesian network<a class="anchor" aria-label="anchor" href="#specifying-a-bayesian-network"></a>
</h4>
<p>A simple way of specifying the model for the chest clinic example is
as follows.</p>
<p>Specify conditional probability tables (with values as given in <span class="citation">Lauritzen and Spiegelhalter (1988)</span>) (there are
other ways of specifying conditional probability tables, see the package
documentation):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">yn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yes"</span>,<span class="st">"no"</span><span class="op">)</span></span>
<span><span class="va">a</span>    <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt.html">cpt</a></span><span class="op">(</span><span class="op">~</span><span class="va">asia</span>, values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">99</span><span class="op">)</span>,levels<span class="op">=</span><span class="va">yn</span><span class="op">)</span></span>
<span><span class="va">t.a</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt.html">cpt</a></span><span class="op">(</span><span class="op">~</span><span class="va">tub</span><span class="op">|</span><span class="va">asia</span>, values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">95</span>, <span class="fl">1</span>, <span class="fl">99</span><span class="op">)</span>,levels<span class="op">=</span><span class="va">yn</span><span class="op">)</span></span>
<span><span class="va">s</span>    <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt.html">cpt</a></span><span class="op">(</span><span class="op">~</span><span class="va">smoke</span>, values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, levels<span class="op">=</span><span class="va">yn</span><span class="op">)</span></span>
<span><span class="va">l.s</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt.html">cpt</a></span><span class="op">(</span><span class="op">~</span><span class="va">lung</span><span class="op">|</span><span class="va">smoke</span>, values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">99</span><span class="op">)</span>, levels<span class="op">=</span><span class="va">yn</span><span class="op">)</span></span>
<span><span class="va">b.s</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt.html">cpt</a></span><span class="op">(</span><span class="op">~</span><span class="va">bronc</span><span class="op">|</span><span class="va">smoke</span>, values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">7</span><span class="op">)</span>, levels<span class="op">=</span><span class="va">yn</span><span class="op">)</span></span>
<span><span class="va">e.lt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt.html">cpt</a></span><span class="op">(</span><span class="op">~</span><span class="va">either</span><span class="op">|</span><span class="va">lung</span><span class="op">:</span><span class="va">tub</span>,values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,levels<span class="op">=</span><span class="va">yn</span><span class="op">)</span></span>
<span><span class="va">x.e</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt.html">cpt</a></span><span class="op">(</span><span class="op">~</span><span class="va">xray</span><span class="op">|</span><span class="va">either</span>, values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">98</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">95</span><span class="op">)</span>, levels<span class="op">=</span><span class="va">yn</span><span class="op">)</span></span>
<span><span class="va">d.be</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt.html">cpt</a></span><span class="op">(</span><span class="op">~</span><span class="va">dysp</span><span class="op">|</span><span class="va">bronc</span><span class="op">:</span><span class="va">either</span>, values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">7</span>, <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span>, levels<span class="op">=</span><span class="va">yn</span><span class="op">)</span></span></code></pre></div>
<p>Compile list of conditional probability tables.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_cpt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/components_gather.html">compile_cpt</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">t.a</span>, <span class="va">s</span>, <span class="va">l.s</span>, <span class="va">b.s</span>, <span class="va">e.lt</span>, <span class="va">x.e</span>, <span class="va">d.be</span><span class="op">)</span></span>
<span><span class="va">chest_cpt</span></span></code></pre></div>
<pre><code><span><span class="co">##  P( asia )</span></span>
<span><span class="co">##  P( tub | asia )</span></span>
<span><span class="co">##  P( smoke )</span></span>
<span><span class="co">##  P( lung | smoke )</span></span>
<span><span class="co">##  P( bronc | smoke )</span></span>
<span><span class="co">##  P( either | lung tub )</span></span>
<span><span class="co">##  P( xray | either )</span></span>
<span><span class="co">##  P( dysp | bronc either )</span></span></code></pre>
<p>The components are arrays, but coercion into dataframes sometimes
makes it easier to digest the components.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_cpt</span><span class="op">$</span><span class="va">tub</span></span></code></pre></div>
<pre><code><span><span class="co">##      asia</span></span>
<span><span class="co">## tub    yes   no</span></span>
<span><span class="co">##   yes 0.05 0.01</span></span>
<span><span class="co">##   no  0.95 0.99</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_cpt</span><span class="op">$</span><span class="va">tub</span>  <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">as.data.frame.table</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   tub asia Freq</span></span>
<span><span class="co">## 1 yes  yes 0.05</span></span>
<span><span class="co">## 2  no  yes 0.95</span></span>
<span><span class="co">## 3 yes   no 0.01</span></span>
<span><span class="co">## 4  no   no 0.99</span></span></code></pre>
<p>Create the network:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_bn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain-main.html">grain</a></span><span class="op">(</span><span class="va">chest_cpt</span><span class="op">)</span></span>
<span><span class="va">chest_bn</span></span></code></pre></div>
<pre><code><span><span class="co">## Independence network: Compiled: TRUE Propagated: FALSE Evidence: FALSE</span></span></code></pre>
<p>Default is that the network is compiled at creation time, but if one
chooses not to do so, compilation can be done with:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_bn</span> <span class="op">&lt;-</span> <span class="fu">compile</span><span class="op">(</span><span class="va">chest_bn</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sec:querying-network">Setting evidence and querying a network<a class="anchor" aria-label="anchor" href="#sec:querying-network"></a>
</h4>
<p>In the chest clinic example, there are three disease variables, two
background variables and two symptoms. Following the narrative, we can
set evidence that a person has recently visited Asia and has
dyspnoea:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">disease</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tub"</span>, <span class="st">"lung"</span>, <span class="st">"bronc"</span><span class="op">)</span></span>
<span><span class="va">asia_dysp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>asia<span class="op">=</span><span class="st">"yes"</span>, dysp<span class="op">=</span><span class="st">"yes"</span><span class="op">)</span></span></code></pre></div>
<p>Initially, the network can be queried without evidence:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_bn</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/querygrain.html">qgrain</a></span><span class="op">(</span>nodes<span class="op">=</span><span class="va">disease</span>, type<span class="op">=</span><span class="st">"marginal"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $tub</span></span>
<span><span class="co">## tub</span></span>
<span><span class="co">##    yes     no </span></span>
<span><span class="co">## 0.0104 0.9896 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $lung</span></span>
<span><span class="co">## lung</span></span>
<span><span class="co">##   yes    no </span></span>
<span><span class="co">## 0.055 0.945 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $bronc</span></span>
<span><span class="co">## bronc</span></span>
<span><span class="co">##  yes   no </span></span>
<span><span class="co">## 0.45 0.55</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_bn</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/querygrain.html">qgrain</a></span><span class="op">(</span>nodes<span class="op">=</span><span class="va">disease</span>, type<span class="op">=</span><span class="st">"marginal"</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          yes     no</span></span>
<span><span class="co">## tub   0.0104 0.9896</span></span>
<span><span class="co">## lung  0.0550 0.9450</span></span>
<span><span class="co">## bronc 0.4500 0.5500</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_bn</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/querygrain.html">qgrain</a></span><span class="op">(</span>nodes<span class="op">=</span><span class="va">disease</span>, type<span class="op">=</span><span class="st">"joint"</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## , , bronc = yes</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      lung</span></span>
<span><span class="co">## tub         yes       no</span></span>
<span><span class="co">##   yes 0.0003276 0.004352</span></span>
<span><span class="co">##   no  0.0311724 0.414148</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , bronc = no</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      lung</span></span>
<span><span class="co">## tub         yes       no</span></span>
<span><span class="co">##   yes 0.0002444 0.005476</span></span>
<span><span class="co">##   no  0.0232556 0.521024</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_bn</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/querygrain.html">qgrain</a></span><span class="op">(</span>nodes<span class="op">=</span><span class="va">disease</span>, type<span class="op">=</span><span class="st">"joint"</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   tub lung bronc      Freq</span></span>
<span><span class="co">## 1 yes  yes   yes 0.0003276</span></span>
<span><span class="co">## 2  no  yes   yes 0.0311724</span></span>
<span><span class="co">## 3 yes   no   yes 0.0043524</span></span>
<span><span class="co">## 4  no   no   yes 0.4141476</span></span>
<span><span class="co">## 5 yes  yes    no 0.0002444</span></span>
<span><span class="co">## 6  no  yes    no 0.0232556</span></span>
<span><span class="co">## 7 yes   no    no 0.0054756</span></span>
<span><span class="co">## 8  no   no    no 0.5210244</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_bn</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/querygrain.html">qgrain</a></span><span class="op">(</span>nodes<span class="op">=</span><span class="va">disease</span>, type<span class="op">=</span><span class="st">"conditional"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## , , bronc = yes</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      lung</span></span>
<span><span class="co">## tub      yes     no</span></span>
<span><span class="co">##   yes 0.0104 0.0104</span></span>
<span><span class="co">##   no  0.9896 0.9896</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , bronc = no</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      lung</span></span>
<span><span class="co">## tub      yes     no</span></span>
<span><span class="co">##   yes 0.0104 0.0104</span></span>
<span><span class="co">##   no  0.9896 0.9896</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_bn</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/querygrain.html">qgrain</a></span><span class="op">(</span>nodes<span class="op">=</span><span class="va">disease</span>, type<span class="op">=</span><span class="st">"conditional"</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   tub lung bronc   Freq</span></span>
<span><span class="co">## 1 yes  yes   yes 0.0104</span></span>
<span><span class="co">## 2  no  yes   yes 0.9896</span></span>
<span><span class="co">## 3 yes   no   yes 0.0104</span></span>
<span><span class="co">## 4  no   no   yes 0.9896</span></span>
<span><span class="co">## 5 yes  yes    no 0.0104</span></span>
<span><span class="co">## 6  no  yes    no 0.9896</span></span>
<span><span class="co">## 7 yes   no    no 0.0104</span></span>
<span><span class="co">## 8  no   no    no 0.9896</span></span></code></pre>
<p>Above we obtain the marginal, joint distributions and conditional
distribution for the disease variables. The output can in some cases be
simplified to dataframes. For the conditional distribution, we obtain
the conditional distribution of the first node given the rest of the
nodes.</p>
</div>
</div>
<div class="section level3">
<h3 id="setting-evidence">Setting evidence<a class="anchor" aria-label="anchor" href="#setting-evidence"></a>
</h3>
<p>Evidence can be entered in different ways:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">asia_dysp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>asia<span class="op">=</span><span class="st">"yes"</span>, dysp<span class="op">=</span><span class="st">"yes"</span><span class="op">)</span></span>
<span><span class="va">chest_ev</span> <span class="op">&lt;-</span> <span class="va">chest_bn</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/grain_evidence.html">setEvidence</a></span><span class="op">(</span>evidence<span class="op">=</span><span class="va">asia_dysp</span><span class="op">)</span></span>
<span><span class="co">## chest_ev &lt;- chest_bn |&gt; ## For backward compatibility</span></span>
<span><span class="co">##    setEvidence(nodes=c("asia", "dysp"), states=c("yes", "yes"))</span></span></code></pre></div>
<p>The evidence is a list and can conveniently be displayed as a
dataframe:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_ev</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/grain_evidence.html">getEvidence</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   nodes is_hard hard_state evi_weight</span></span>
<span><span class="co">## 1  asia    TRUE        yes       1, 0</span></span>
<span><span class="co">## 2  dysp    TRUE        yes       1, 0</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_ev</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span>nodes<span class="op">=</span><span class="va">disease</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           yes     no</span></span>
<span><span class="co">## tub   0.08775 0.9122</span></span>
<span><span class="co">## lung  0.09953 0.9005</span></span>
<span><span class="co">## bronc 0.81140 0.1886</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_ev</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/grain_evidence.html">pEvidence</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.004501</span></span></code></pre>
<p>The network can be queried again, and we can also obtain the
probability of observing this evidence:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_ev</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span>nodes<span class="op">=</span><span class="va">disease</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           yes     no</span></span>
<span><span class="co">## tub   0.08775 0.9122</span></span>
<span><span class="co">## lung  0.09953 0.9005</span></span>
<span><span class="co">## bronc 0.81140 0.1886</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_ev</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/grain_evidence.html">pEvidence</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.004501</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_bn</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/grain_evidence.html">pEvidence</a></span><span class="op">(</span>evidence<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>asia<span class="op">=</span><span class="st">"yes"</span>, dysp<span class="op">=</span><span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.004501</span></span></code></pre>
<p>The probability of observing a specific evidence can be found by
setting the evidence as a vector of weights. This is useful in
connection with soft evidence (also called likelihood evidence), see
Section~@ref(sec:hard-soft).</p>
</div>
<div class="section level3">
<h3 id="sec:small-shortcuts">Hints and shortcuts<a class="anchor" aria-label="anchor" href="#sec:small-shortcuts"></a>
</h3>
<p>An alternative way of specifying a network is by first defining CPTs
and then entering values afterwards. Programmatically, this can be done
as:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">yn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">node_parents_list</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"asia"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tub"</span>, <span class="st">"asia"</span><span class="op">)</span>, <span class="st">"smoke"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lung"</span>, <span class="st">"smoke"</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bronc"</span>, <span class="st">"smoke"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"either"</span>, <span class="st">"tub"</span>, <span class="st">"lung"</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"xray"</span>, <span class="st">"either"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dysp"</span>, <span class="st">"bronc"</span>, <span class="st">"either"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## nms &lt;- unique(unlist(node_parents_list))</span></span>
<span><span class="co">## universe &lt;- setNames(rep(list(yn),length(nms)), nms)</span></span>
<span><span class="co">## universe |&gt; head(3)</span></span>
<span></span>
<span><span class="va">chest_dummy_cpt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">node_parents_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/cpt.html">cpt</a></span><span class="op">(</span><span class="va">f</span>, levels<span class="op">=</span><span class="va">yn</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">bn_template</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/components_gather.html">compile_cpt</a></span><span class="op">(</span><span class="va">chest_dummy_cpt2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/grain-main.html">grain</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Above the network has ones in all potentials. Next update values in
(some of the) potentials:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cpt_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>asia<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">99</span><span class="op">)</span>,</span>
<span>                   tub<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">95</span>, <span class="fl">1</span>, <span class="fl">99</span><span class="op">)</span>,</span>
<span>                   smoke<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>                   lung<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">99</span><span class="op">)</span>,            </span>
<span>                   bronc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>                   either<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                   xray<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">98</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">95</span><span class="op">)</span>,</span>
<span>                   dysp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">7</span>, <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span></span>
<span>                   <span class="op">)</span></span>
<span></span>
<span><span class="va">bn_real</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/replace-cpt.html">replace_cpt</a></span><span class="op">(</span><span class="va">bn_template</span>, <span class="va">cpt_values</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bn_template</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/querygrain.html">qgrain</a></span><span class="op">(</span>evi<span class="op">=</span><span class="va">asia_dysp</span>, nodes<span class="op">=</span><span class="va">disease</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       yes  no</span></span>
<span><span class="co">## tub   0.5 0.5</span></span>
<span><span class="co">## lung  0.5 0.5</span></span>
<span><span class="co">## bronc 0.5 0.5</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bn_real</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/querygrain.html">qgrain</a></span><span class="op">(</span>evi<span class="op">=</span><span class="va">asia_dysp</span>, nodes<span class="op">=</span><span class="va">disease</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           yes     no</span></span>
<span><span class="co">## tub   0.08775 0.9122</span></span>
<span><span class="co">## lung  0.09953 0.9005</span></span>
<span><span class="co">## bronc 0.81140 0.1886</span></span></code></pre>
<p>Consider querying a network where focus is on marginal distributions
(the default). If all variables have the same levels (as the case is
here), the output can be coerced to a dataframe:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">chest_bn</span>, nodes<span class="op">=</span><span class="va">disease</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          yes     no</span></span>
<span><span class="co">## tub   0.0104 0.9896</span></span>
<span><span class="co">## lung  0.0550 0.9450</span></span>
<span><span class="co">## bronc 0.4500 0.5500</span></span></code></pre>
<p>In the more general case the output can be coerced to a list of
dataframes</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">chest_bn</span>, nodes<span class="op">=</span><span class="va">disease</span>, result<span class="op">=</span><span class="st">"data.frame"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $tub</span></span>
<span><span class="co">## tub</span></span>
<span><span class="co">##    yes     no </span></span>
<span><span class="co">## 0.0104 0.9896 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $lung</span></span>
<span><span class="co">## lung</span></span>
<span><span class="co">##   yes    no </span></span>
<span><span class="co">## 0.055 0.945 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $bronc</span></span>
<span><span class="co">## bronc</span></span>
<span><span class="co">##  yes   no </span></span>
<span><span class="co">## 0.45 0.55</span></span></code></pre>
<p>A typical use of gRain involves setting evidence and then querying
the network afterwards. This can all be done in one call of
<code><a href="../reference/querygrain.html">querygrain()</a></code> (notice that this does not alter the network
object):</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_bn</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span>evidence<span class="op">=</span><span class="va">asia_dysp</span>,</span>
<span>                       nodes<span class="op">=</span><span class="va">disease</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           yes     no</span></span>
<span><span class="co">## tub   0.08775 0.9122</span></span>
<span><span class="co">## lung  0.09953 0.9005</span></span>
<span><span class="co">## bronc 0.81140 0.1886</span></span></code></pre>
<p>Evidence can be also be given as a vector of weights.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_bn</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span>evidence<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>asia<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, dysp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       nodes<span class="op">=</span><span class="va">disease</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           yes     no</span></span>
<span><span class="co">## tub   0.08775 0.9122</span></span>
<span><span class="co">## lung  0.09953 0.9005</span></span>
<span><span class="co">## bronc 0.81140 0.1886</span></span></code></pre>
<p>The weights must be non-negative but need not sum to one. This is
important in connection with soft evidence (also called likelihood
evidence), see Section~@ref(sec:hard-soft). Above, the weights could
also have been set as c(.1, 0). The important part is that the zero
excludes certain states as being impossible.</p>
<p>Nodes on which evidence is given are not reported unless
<code>exclude=FALSE</code></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">chest_bn</span>,</span>
<span>           evidence<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>asia<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, dysp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           nodes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lung"</span>, <span class="st">"bronc"</span>, <span class="st">"asia"</span>, <span class="st">"dysp"</span><span class="op">)</span>,</span>
<span>           exclude<span class="op">=</span><span class="cn">FALSE</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           yes     no</span></span>
<span><span class="co">## lung  0.09953 0.9005</span></span>
<span><span class="co">## bronc 0.81140 0.1886</span></span>
<span><span class="co">## asia  1.00000 0.0000</span></span>
<span><span class="co">## dysp  1.00000 0.0000</span></span></code></pre>
<p>If <code>nodes</code>are not specified, queries for all nodes without
evidence are reported.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">chest_bn</span>,</span>
<span>           evidence<span class="op">=</span><span class="va">asia_dysp</span>,</span>
<span>           simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##            yes     no</span></span>
<span><span class="co">## NA          NA     NA</span></span>
<span><span class="co">## tub    0.08775 0.9122</span></span>
<span><span class="co">## smoke  0.62592 0.3741</span></span>
<span><span class="co">## lung   0.09953 0.9005</span></span>
<span><span class="co">## bronc  0.81140 0.1886</span></span>
<span><span class="co">## either 0.18230 0.8177</span></span>
<span><span class="co">## xray   0.21954 0.7805</span></span>
<span><span class="co">## NA.1        NA     NA</span></span></code></pre>
<p>If <code>nodes</code> are not specified and
<code>exclude=FALSE</code>, then queries for all nodes are reported.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">chest_bn</span>,</span>
<span>           evidence<span class="op">=</span><span class="va">asia_dysp</span>,</span>
<span>           exclude <span class="op">=</span> <span class="cn">FALSE</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##            yes     no</span></span>
<span><span class="co">## asia   1.00000 0.0000</span></span>
<span><span class="co">## tub    0.08775 0.9122</span></span>
<span><span class="co">## smoke  0.62592 0.3741</span></span>
<span><span class="co">## lung   0.09953 0.9005</span></span>
<span><span class="co">## bronc  0.81140 0.1886</span></span>
<span><span class="co">## either 0.18230 0.8177</span></span>
<span><span class="co">## xray   0.21954 0.7805</span></span>
<span><span class="co">## dysp   1.00000 0.0000</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="sec:zero-probabilities">Conditioning on evidence with zero probability<a class="anchor" aria-label="anchor" href="#sec:zero-probabilities"></a>
</h3>
<p>Consider setting the evidence</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_bn3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain_evidence.html">setEvidence</a></span><span class="op">(</span><span class="va">chest_bn</span>, evidence<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>either<span class="op">=</span><span class="st">"no"</span>, tub<span class="op">=</span><span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Under the model, this specific evidence has zero probability:
<code>either</code> is true if <code>tub</code> is true or
<code>lung</code> is true (or both). Hence the specific evidence is
impossible and therefore, all conditional probabilities are (under the
model) undefined:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grain_evidence.html">pEvidence</a></span><span class="op">(</span><span class="va">chest_bn3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">chest_bn3</span>, nodes<span class="op">=</span><span class="va">disease</span>, type<span class="op">=</span><span class="st">"joint"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      bronc</span></span>
<span><span class="co">## lung  yes  no</span></span>
<span><span class="co">##   yes NaN NaN</span></span>
<span><span class="co">##   no  NaN NaN</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="sec:hard-soft">Hard and soft (likelihood) evidence<a class="anchor" aria-label="anchor" href="#sec:hard-soft"></a>
</h3>
<p>Below we describe how to work with virtual evidence (also known as
soft evidence or likelihood evidence) in gRain. This is done via the
function setEvidence().</p>
<p>The clique potential representation in a Bayesian network gives
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∝</mo><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>∏</mo><mi>C</mi></munder><msub><mi>ψ</mi><mi>C</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>C</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  p(x) \propto \psi(x) = \prod_{C} \psi_C(x_C).
\end{align}</annotation></semantics></math></p>
<p>Here we recall that the whole idea in computations with Bayesian
networks is to avoid calculation the product on the right hand side
above. Instead computations are based on propagation (multiplying,
dividing and summing clique potentials
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ψ</mi><mi>C</mi></msub><annotation encoding="application/x-tex">\psi_C</annotation></semantics></math>
in an appropriate order, and such an appropriate order comes from a
junction tree). The normalizing constant, say
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><msub><mo>∑</mo><mi>x</mi></msub><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c=\sum_x \psi(x)</annotation></semantics></math>,
comes out of propagation as a “by-product”.</p>
<p>Suppose a set of nodes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>E</mi><annotation encoding="application/x-tex">E</annotation></semantics></math>
are known to have a specific value,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>E</mi></msub><mo>=</mo><msubsup><mi>x</mi><mi>E</mi><mo>*</mo></msubsup></mrow><annotation encoding="application/x-tex">x_E=x^*_E</annotation></semantics></math>.
This is called hard evidence. The probability of the event
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>E</mi></msub><mo>=</mo><msubsup><mi>x</mi><mi>E</mi><mo>*</mo></msubsup></mrow><annotation encoding="application/x-tex">x_E=x^*_E</annotation></semantics></math>
is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>E</mi></msub><mo>=</mo><msubsup><mi>x</mi><mi>E</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>E</mi><mi>p</mi></msub><mo stretchy="false" form="prefix">{</mo><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>E</mi></msub><mo>=</mo><msubsup><mi>x</mi><mi>E</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mo>=</mo><munder><mo>∑</mo><mi>x</mi></munder><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>E</mi></msub><mo>=</mo><msubsup><mi>x</mi><mi>E</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>c</mi></mfrac><munder><mo>∑</mo><mi>x</mi></munder><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>E</mi></msub><mo>=</mo><msubsup><mi>x</mi><mi>E</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  p(x_E=x^*_E)=E_p\{I(x_E=x^*_E)\} = \sum_x I(x_E=x^*_E) p(x)
  = \frac{1}{c} \sum_x I(x_E=x^*_E) \psi(x)
\end{align}</annotation></semantics></math></p>
<p>The computations are based on modifying the clique potentials
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ψ</mi><mi>C</mi></msub><annotation encoding="application/x-tex">\psi_C</annotation></semantics></math>
by giving value zero to states in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ψ</mi><mi>C</mi></msub><annotation encoding="application/x-tex">\psi_C</annotation></semantics></math>
which are not consistent with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>E</mi></msub><mo>=</mo><msubsup><mi>x</mi><mi>E</mi><mo>*</mo></msubsup></mrow><annotation encoding="application/x-tex">x_E=x^*_E</annotation></semantics></math>.
This can be achieved with an indicator function, say
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>C</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>C</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L_C(x_C)</annotation></semantics></math>
such that we obtain a set of new potentials
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>ψ</mi><mo accent="true">̃</mo></mover><mi>C</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>L</mi><mi>C</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>C</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ψ</mi><mi>C</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>C</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tilde \psi_C(x) = L_C(x_C) \psi_C(x_C)</annotation></semantics></math>.
Propagation with these new potentials gives, as a by product,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>c</mi><mo accent="true">̃</mo></mover><mo>=</mo><mo>∑</mo><mover><mi>ψ</mi><mo accent="true">̃</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tilde c=\sum \tilde \psi(x)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ψ</mi><mo accent="true">̃</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mo>∏</mo><mi>C</mi></msub><msub><mover><mi>ψ</mi><mo accent="true">̃</mo></mover><mi>C</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>C</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tilde\psi(x)= \prod_C \tilde\psi_C(x_C)</annotation></semantics></math>.
Consequently, we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>E</mi></msub><mo>=</mo><msubsup><mi>x</mi><mi>E</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mover><mi>c</mi><mo accent="true">̃</mo></mover><mi>/</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">p(x_E=x^*_E)=\tilde c / c</annotation></semantics></math>.</p>
<p>In a more general setting we may have non–negative weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L(x)</annotation></semantics></math>
for each value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>.
We may calculate
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>E</mi><mi>p</mi></msub><mo stretchy="false" form="prefix">{</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mo>=</mo><munder><mo>∑</mo><mi>x</mi></munder><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  E_p\{L(X)\} = \sum_x L(x)p(x)
\end{align}</annotation></semantics></math> If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L(X)</annotation></semantics></math>
factorizes as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mo>∏</mo><mi>C</mi></msub><msub><mi>L</mi><mi>C</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>C</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L(X)= \prod_C L_C(X_C)</annotation></semantics></math>
then the computations are carried out as outlined above, i.e. by the
message passing scheme.</p>
<div class="section level4">
<h4 id="sec:hard-evidence">Hard evidence<a class="anchor" aria-label="anchor" href="#sec:hard-evidence"></a>
</h4>
<p>Suppose we want to make a diagnosis about tuberculosis given the
evidence that a person is a smoker. We call such evidence hard evidence
because the state of the variables are known with certainty. The
function setEvidence() can be used for this purpose. The following forms
are equivalent (the reason will be explained below):</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_ev1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain_evidence.html">setEvidence</a></span><span class="op">(</span><span class="va">chest_bn</span>, evidence<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>smoke<span class="op">=</span><span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">chest_ev2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain_evidence.html">setEvidence</a></span><span class="op">(</span><span class="va">chest_bn</span>, evidence<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>smoke<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_bn</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span>nodes<span class="op">=</span><span class="va">disease</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          yes     no</span></span>
<span><span class="co">## tub   0.0104 0.9896</span></span>
<span><span class="co">## lung  0.0550 0.9450</span></span>
<span><span class="co">## bronc 0.4500 0.5500</span></span></code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_ev1</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span>nodes<span class="op">=</span><span class="va">disease</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          yes     no</span></span>
<span><span class="co">## tub   0.0104 0.9896</span></span>
<span><span class="co">## lung  0.1000 0.9000</span></span>
<span><span class="co">## bronc 0.6000 0.4000</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="sec:virt-evid-likel">Soft evidence (also called virtual evidence or likelihood
evidence)<a class="anchor" aria-label="anchor" href="#sec:virt-evid-likel"></a>
</h4>
<p>Suppose we are not certain if a patient is a smoker or not. We shall
assume that for patients who are smokers, we would (correctly) guess so
in 80% of the cases, whereas for patients who are not smokers we would
(erroneously) guess that they are smokers in 10% of the cases.</p>
<p>In gRain this, situation can be handled in two different ways. One
way is to introduce a new variable <code>smoke_guess</code> with
<code>smoke</code> as its only parent and then we enter evidence for
this node.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g.s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt.html">cpt</a></span><span class="op">(</span><span class="op">~</span> <span class="va">smoke_guess</span><span class="op">|</span><span class="va">smoke</span>, levels<span class="op">=</span><span class="va">yn</span>,</span>
<span>              values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">.2</span>, <span class="fl">.1</span>, <span class="fl">.9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">g.s</span></span></code></pre></div>
<pre><code><span><span class="co">##            smoke</span></span>
<span><span class="co">## smoke_guess yes  no</span></span>
<span><span class="co">##         yes 0.8 0.1</span></span>
<span><span class="co">##         no  0.2 0.9</span></span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cpt_list</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">g.s</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/components_gather.html">compile_cpt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/grain-main.html">grain</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">chest_ext</span>, nodes<span class="op">=</span><span class="va">disease</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          yes     no</span></span>
<span><span class="co">## tub   0.0104 0.9896</span></span>
<span><span class="co">## lung  0.0550 0.9450</span></span>
<span><span class="co">## bronc 0.4500 0.5500</span></span></code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">chest_ext</span>, nodes<span class="op">=</span><span class="va">disease</span>, evidence<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>smoke<span class="op">=</span><span class="st">"yes"</span><span class="op">)</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          yes     no</span></span>
<span><span class="co">## tub   0.0104 0.9896</span></span>
<span><span class="co">## lung  0.1000 0.9000</span></span>
<span><span class="co">## bronc 0.6000 0.4000</span></span></code></pre>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">chest_ext</span>, nodes<span class="op">=</span><span class="va">disease</span>, evidence<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>smoke_guess<span class="op">=</span><span class="st">"yes"</span><span class="op">)</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          yes     no</span></span>
<span><span class="co">## tub   0.0104 0.9896</span></span>
<span><span class="co">## lung  0.0900 0.9100</span></span>
<span><span class="co">## bronc 0.5667 0.4333</span></span></code></pre>
<p>Another approach is to enter virtual evidence in the original network
as shown below.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_ve</span> <span class="op">&lt;-</span> <span class="va">chest_bn</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/grain_evidence.html">setEvidence</a></span><span class="op">(</span>evidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>smoke <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">chest_ve</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span>nodes<span class="op">=</span><span class="va">disease</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          yes     no</span></span>
<span><span class="co">## tub   0.0104 0.9896</span></span>
<span><span class="co">## lung  0.0900 0.9100</span></span>
<span><span class="co">## bronc 0.5667 0.4333</span></span></code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grain_evidence.html">getEvidence</a></span><span class="op">(</span><span class="va">chest_ve</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $nodes</span></span>
<span><span class="co">## [1] "smoke"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $is_hard</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $hard_state</span></span>
<span><span class="co">## [1] NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $evi_weight</span></span>
<span><span class="co">## $evi_weight[[1]]</span></span>
<span><span class="co">## smoke</span></span>
<span><span class="co">## yes  no </span></span>
<span><span class="co">## 0.8 0.1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "grain_evidence" "list"</span></span></code></pre>
<p>Consequently, specifying the hard evidence that
<code>smoke="yes"</code> can be done as</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chest_bn</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/grain_evidence.html">setEvidence</a></span><span class="op">(</span>evidence<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>smoke<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Independence network: Compiled: TRUE Propagated: TRUE Evidence: TRUE</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="sec:using-data">Building a network from data<a class="anchor" aria-label="anchor" href="#sec:using-data"></a>
</h3>
<p>When building a network from data, there are two situations to be
distinguished between. 1) The network is known and the data is used to
estimate the parameters in the network. 2) The network is unknown and
the data is used to estimate the network structure and the parameters in
the network.</p>
<p>In both cases it is possible to have a network specified as a dag or
as an undirected (chordal) graph. The following code illustrates how to
build a network from data. The data is simulated data from the chest
clinic example.</p>
<div class="section level4">
<h4 id="sec:building-known">Building a network from a known network<a class="anchor" aria-label="anchor" href="#sec:building-known"></a>
</h4>
<p>The following list defines a dag for the chest clinic example: Each
component is a list with two elements: the first element is the node and
the second element is a vector of parents.</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">node_parents_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"asia"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tub"</span>, <span class="st">"asia"</span><span class="op">)</span>, <span class="st">"smoke"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lung"</span>, <span class="st">"smoke"</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bronc"</span>, <span class="st">"smoke"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"either"</span>, <span class="st">"tub"</span>, <span class="st">"lung"</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"xray"</span>, <span class="st">"either"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dysp"</span>, <span class="st">"bronc"</span>, <span class="st">"either"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu">dag</span><span class="op">(</span><span class="va">node_parents_list</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/grain-unnamed-chunk-35-1.png" width="480"></p>
<p>The following list defines an undirected graph for the chest clinic
example: Each component is a list with the nodes in the clique.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cliq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"xray"</span>, <span class="st">"either"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"asia"</span>, <span class="st">"tub"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"smoke"</span>, <span class="st">"lung"</span>, </span>
<span><span class="st">"bronc"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lung"</span>, <span class="st">"either"</span>, <span class="st">"tub"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lung"</span>, <span class="st">"either"</span>, <span class="st">"bronc"</span></span>
<span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bronc"</span>, <span class="st">"either"</span>, <span class="st">"dysp"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu">ug</span><span class="op">(</span><span class="va">cliq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/grain-unnamed-chunk-36-1.png" width="480"></p>
<p>A netowrk can be built from data using:</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bn1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain-main.html">grain</a></span><span class="op">(</span><span class="va">g1</span>, data<span class="op">=</span><span class="fu">gRbase</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/gRbase/man/data-chestSim.html" class="external-link">chestSim100000</a></span><span class="op">)</span></span>
<span><span class="va">bn2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain-main.html">grain</a></span><span class="op">(</span><span class="va">g2</span>, data<span class="op">=</span><span class="fu">gRbase</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/gRbase/man/data-chestSim.html" class="external-link">chestSim100000</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## NAs found in clique potential(s) for clique(s): </span></span>
<span><span class="co">## c("bronc", "lung", "either") </span></span>
<span><span class="co">##   ... consider using the smooth argument</span></span></code></pre>
<p>It is explained in the references that the two networks specify the
same joint distribution because internally a dag is converted to an
undirected chordal graph which provides the basis for the computations.
In practice the two joint distributions differ slightly, and this is
because the way in which information is extracted from data, see
examples below.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">j1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">bn1</span>, type<span class="op">=</span><span class="st">"joint"</span><span class="op">)</span></span>
<span><span class="va">j2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">bn2</span>, type<span class="op">=</span><span class="st">"joint"</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">j1</span> <span class="op">%a-%</span> <span class="va">j2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] NaN</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="sec:building-networks">Building networks from data<a class="anchor" aria-label="anchor" href="#sec:building-networks"></a>
</h3>
<p>The following two graphs specify the same model stating that A and C
are conditionally independent given B. The first graph is a directed
acyclic graph (DAG) and the second graph is an undirected graph
(UG).</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g1</span>  <span class="op">&lt;-</span> <span class="fu">dag</span><span class="op">(</span><span class="op">~</span><span class="va">A</span><span class="op">:</span><span class="va">C</span> <span class="op">+</span> <span class="va">B</span><span class="op">:</span><span class="va">C</span>, result<span class="op">=</span><span class="st">"igraph"</span><span class="op">)</span></span>
<span><span class="va">g2</span>  <span class="op">&lt;-</span> <span class="fu">ug</span><span class="op">(</span><span class="op">~</span><span class="va">A</span><span class="op">:</span><span class="va">C</span> <span class="op">+</span> <span class="va">B</span><span class="op">:</span><span class="va">C</span>, result<span class="op">=</span><span class="st">"igraph"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/grain-unnamed-chunk-39-1.png" width="480"></p>
<p>Given such a graph, we can build a network from data. Suppose data is
as follows:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu">tabNew</span><span class="op">(</span><span class="op">~</span><span class="va">A</span><span class="op">:</span><span class="va">B</span><span class="op">:</span><span class="va">C</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+"</span>, <span class="st">"-"</span><span class="op">)</span>, </span>
<span>              values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>A network can be built from data using:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bn1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain-main.html">grain</a></span><span class="op">(</span><span class="va">g1</span>, data<span class="op">=</span><span class="va">tab</span><span class="op">)</span></span>
<span><span class="va">bn2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain-main.html">grain</a></span><span class="op">(</span><span class="va">g2</span>, data<span class="op">=</span><span class="va">tab</span><span class="op">)</span></span></code></pre></div>
<p>The two networks specify the same joint distribution:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">j1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">bn1</span>, type<span class="op">=</span><span class="st">"joint"</span><span class="op">)</span></span>
<span><span class="va">j2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">bn2</span>, type<span class="op">=</span><span class="st">"joint"</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">j1</span> <span class="op">%a-%</span> <span class="va">j2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.776e-17</span></span></code></pre>
<p>In the process of creating networks, conditional probability tables
are extracted when the graph is a dag and clique potentials are
extracted when the graph is a chordal (i.e. triangulated) undirected
graph. This takes place as follows (internally):</p>
<p>Neet to estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo stretchy="false" form="prefix">|</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(A|B)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><mo stretchy="false" form="prefix">|</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(C|B)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(B)</annotation></semantics></math>
from the data. This can be done as follows:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/components_extract.html">extract_cpt</a></span><span class="op">(</span><span class="va">tab</span>, <span class="va">g1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## C</span></span>
<span><span class="co">##      +      - </span></span>
<span><span class="co">## 0.5789 0.4211 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##    C</span></span>
<span><span class="co">## A        +    -</span></span>
<span><span class="co">##   + 0.3636 0.25</span></span>
<span><span class="co">##   - 0.6364 0.75</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[3]]</span></span>
<span><span class="co">##    C</span></span>
<span><span class="co">## B        +     -</span></span>
<span><span class="co">##   + 0.2727 0.375</span></span>
<span><span class="co">##   - 0.7273 0.625</span></span></code></pre>
<p>Likewise, we can extract the clique potentials from the data, call
these
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">q(AC)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">q(BC)</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/components_extract.html">extract_pot</a></span><span class="op">(</span><span class="va">tab</span>, <span class="va">g2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">q</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">##    C</span></span>
<span><span class="co">## A        +      -</span></span>
<span><span class="co">##   + 0.2105 0.1053</span></span>
<span><span class="co">##   - 0.3684 0.3158</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##    C</span></span>
<span><span class="co">## B        +     -</span></span>
<span><span class="co">##   + 0.2727 0.375</span></span>
<span><span class="co">##   - 0.7273 0.625</span></span></code></pre>
<p>Clique potentials are not uniquely defined, but the product of clique
potentials is. In the implementation in gRain,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">q(AC)</annotation></semantics></math>
is the relative frequency in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">AC</annotation></semantics></math>-marginal
table,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(AB)</annotation></semantics></math>.
Moreover and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">q(BC)</annotation></semantics></math>
is the frequency in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BC</annotation></semantics></math>-marginal
table divided by the frequency in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>-marginal
table. Hence, the product of the clique potentials and the product of
the cpts is the same as the joint distribution:</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tabProd</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/ftable.html" class="external-link">ftable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     C       +       -</span></span>
<span><span class="co">## A B                  </span></span>
<span><span class="co">## + +   0.05742 0.03947</span></span>
<span><span class="co">##   -   0.15311 0.06579</span></span>
<span><span class="co">## - +   0.10048 0.11842</span></span>
<span><span class="co">##   -   0.26794 0.19737</span></span></code></pre>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tabProd</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/ftable.html" class="external-link">ftable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     C       +       -</span></span>
<span><span class="co">## A B                  </span></span>
<span><span class="co">## + +   0.05742 0.03947</span></span>
<span><span class="co">##   -   0.15311 0.06579</span></span>
<span><span class="co">## - +   0.10048 0.11842</span></span>
<span><span class="co">##   -   0.26794 0.19737</span></span></code></pre>
<div class="section level4">
<h4 id="sec:handling-zeros">Handling zeros in the data<a class="anchor" aria-label="anchor" href="#sec:handling-zeros"></a>
</h4>
<p>Next suppose data is as follows</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab0</span> <span class="op">&lt;-</span> <span class="va">tab</span></span>
<span><span class="va">tab0</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">tab0</span></span></code></pre></div>
<pre><code><span><span class="co">## , , C = +</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    B</span></span>
<span><span class="co">## A   + -</span></span>
<span><span class="co">##   + 0 0</span></span>
<span><span class="co">##   - 0 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , C = -</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    B</span></span>
<span><span class="co">## A   + -</span></span>
<span><span class="co">##   + 1 1</span></span>
<span><span class="co">##   - 2 4</span></span></code></pre>
<p>In the process of creating networks above, the following quantities
are computed:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_BC</span> <span class="op">&lt;-</span> <span class="va">tab0</span> <span class="op">|&gt;</span> <span class="fu">tabMarg</span><span class="op">(</span><span class="op">~</span><span class="va">B</span><span class="op">:</span><span class="va">C</span><span class="op">)</span></span>
<span><span class="va">n_AC</span> <span class="op">&lt;-</span> <span class="va">tab0</span> <span class="op">|&gt;</span> <span class="fu">tabMarg</span><span class="op">(</span><span class="op">~</span><span class="va">A</span><span class="op">:</span><span class="va">C</span><span class="op">)</span></span>
<span><span class="va">n_C</span>  <span class="op">&lt;-</span> <span class="va">tab0</span> <span class="op">|&gt;</span> <span class="fu">tabMarg</span><span class="op">(</span><span class="op">~</span><span class="va">C</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p.B_C</span> <span class="op">&lt;-</span> <span class="va">n_BC</span> <span class="op">%a/%</span> <span class="va">n_C</span></span>
<span><span class="va">p.A_C</span> <span class="op">&lt;-</span> <span class="va">n_AC</span> <span class="op">%a/%</span> <span class="va">n_C</span></span>
<span><span class="va">p.C</span> <span class="op">&lt;-</span> <span class="va">n_C</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n_C</span><span class="op">)</span></span>
<span><span class="va">p.C</span></span></code></pre></div>
<pre><code><span><span class="co">## C</span></span>
<span><span class="co">## + - </span></span>
<span><span class="co">## 0 1</span></span></code></pre>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p.B_C</span></span></code></pre></div>
<pre><code><span><span class="co">##    C</span></span>
<span><span class="co">## B     +     -</span></span>
<span><span class="co">##   + NaN 0.375</span></span>
<span><span class="co">##   - NaN 0.625</span></span></code></pre>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p.A_C</span></span></code></pre></div>
<pre><code><span><span class="co">##    C</span></span>
<span><span class="co">## A     +    -</span></span>
<span><span class="co">##   + NaN 0.25</span></span>
<span><span class="co">##   - NaN 0.75</span></span></code></pre>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bn01</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain-main.html">grain</a></span><span class="op">(</span><span class="va">g1</span>, data<span class="op">=</span><span class="va">tab0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## NAs found in cpt(s) for node(s): A, B</span></span>
<span><span class="co">##   ... consider using the smooth argument</span></span></code></pre>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bn02</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain-main.html">grain</a></span><span class="op">(</span><span class="va">g2</span>, data<span class="op">=</span><span class="va">tab0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## NAs found in clique potential(s) for clique(s): </span></span>
<span><span class="co">## c("B", "C") </span></span>
<span><span class="co">##   ... consider using the smooth argument</span></span></code></pre>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/components_extract.html">extract_cpt</a></span><span class="op">(</span><span class="va">tab0</span>, <span class="va">g1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## NAs found in cpt(s) for node(s): A, B</span></span>
<span><span class="co">##   ... consider using the smooth argument</span></span></code></pre>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/components_extract.html">extract_pot</a></span><span class="op">(</span><span class="va">tab0</span>, <span class="va">g2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## NAs found in clique potential(s) for clique(s): </span></span>
<span><span class="co">## c("B", "C") </span></span>
<span><span class="co">##   ... consider using the smooth argument</span></span></code></pre>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## C</span></span>
<span><span class="co">## + - </span></span>
<span><span class="co">## 0 1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##    C</span></span>
<span><span class="co">## A     +    -</span></span>
<span><span class="co">##   + NaN 0.25</span></span>
<span><span class="co">##   - NaN 0.75</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[3]]</span></span>
<span><span class="co">##    C</span></span>
<span><span class="co">## B     +     -</span></span>
<span><span class="co">##   + NaN 0.375</span></span>
<span><span class="co">##   - NaN 0.625</span></span></code></pre>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">##    C</span></span>
<span><span class="co">## A   +    -</span></span>
<span><span class="co">##   + 0 0.25</span></span>
<span><span class="co">##   - 0 0.75</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##    C</span></span>
<span><span class="co">## B     +     -</span></span>
<span><span class="co">##   + NaN 0.375</span></span>
<span><span class="co">##   - NaN 0.625</span></span></code></pre>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tabProd</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/ftable.html" class="external-link">ftable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     C       +       -</span></span>
<span><span class="co">## A B                  </span></span>
<span><span class="co">## + +       NaN 0.09375</span></span>
<span><span class="co">##   -       NaN 0.15625</span></span>
<span><span class="co">## - +       NaN 0.28125</span></span>
<span><span class="co">##   -       NaN 0.46875</span></span></code></pre>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tabProd</span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/ftable.html" class="external-link">ftable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     C       +       -</span></span>
<span><span class="co">## A B                  </span></span>
<span><span class="co">## + +       NaN 0.09375</span></span>
<span><span class="co">##   -       NaN 0.15625</span></span>
<span><span class="co">## - +       NaN 0.28125</span></span>
<span><span class="co">##   -       NaN 0.46875</span></span></code></pre>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eps</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">bn01e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain-main.html">grain</a></span><span class="op">(</span><span class="va">g1</span>, data<span class="op">=</span><span class="va">tab0</span>, smooth<span class="op">=</span><span class="va">eps</span><span class="op">)</span></span>
<span><span class="va">bn02e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain-main.html">grain</a></span><span class="op">(</span><span class="va">g2</span>, data<span class="op">=</span><span class="va">tab0</span>, smooth<span class="op">=</span><span class="va">eps</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">j1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">bn01e</span>, type<span class="op">=</span><span class="st">"joint"</span><span class="op">)</span></span>
<span><span class="va">j2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">bn02e</span>, type<span class="op">=</span><span class="st">"joint"</span><span class="op">)</span></span>
<span><span class="va">j1</span></span></code></pre></div>
<pre><code><span><span class="co">## , , B = +</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    A</span></span>
<span><span class="co">## C           +         -</span></span>
<span><span class="co">##   + 0.0006219 0.0006219</span></span>
<span><span class="co">##   - 0.0941379 0.2805496</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , B = -</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    A</span></span>
<span><span class="co">## C           +         -</span></span>
<span><span class="co">##   + 0.0006219 0.0006219</span></span>
<span><span class="co">##   - 0.1564809 0.4663440</span></span></code></pre>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">j2</span></span></code></pre></div>
<pre><code><span><span class="co">## , , B = +</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    C</span></span>
<span><span class="co">## A           +       -</span></span>
<span><span class="co">##   + 0.0006219 0.09383</span></span>
<span><span class="co">##   - 0.0006219 0.28055</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , B = -</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    C</span></span>
<span><span class="co">## A           +      -</span></span>
<span><span class="co">##   + 0.0006219 0.1562</span></span>
<span><span class="co">##   - 0.0006219 0.4670</span></span></code></pre>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">j1</span> <span class="op">%a-%</span> <span class="va">j2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.0006182</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="sec:building-unknown">Building a network from an unknown network<a class="anchor" aria-label="anchor" href="#sec:building-unknown"></a>
</h4>
<p>This is a more complex task, sometimes called structural learning.
The following code illustrates how to build a network from data. The
data is simulated data from the chest clinic example.</p>
<p>We illustrate two approaches: 1) based on the stepwise algorithm in
the gRim package and 2) based on the hill climbing algorithm in the
bnlearn package.</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">gRbase</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/gRbase/man/data-chestSim.html" class="external-link">chestSim10000</a></span></span>
<span></span>
<span><span class="co">## Using gRim and stepwise selection</span></span>
<span><span class="va">sat_model</span> <span class="op">&lt;-</span>  <span class="fu">gRim</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gRim/man/imodel-dmod.html" class="external-link">dmod</a></span><span class="op">(</span><span class="op">~</span><span class="va">.</span><span class="op">^</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="va">mm1</span> <span class="op">&lt;-</span> <span class="fu">stepwise</span><span class="op">(</span><span class="va">sat_model</span>, criterion<span class="op">=</span><span class="st">"aic"</span>, type<span class="op">=</span><span class="st">"decomposable"</span><span class="op">)</span></span>
<span><span class="va">bn1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain-main.html">grain</a></span><span class="op">(</span><span class="va">mm1</span><span class="op">$</span><span class="va">modelinfo</span><span class="op">$</span><span class="va">ug</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## NAs found in clique potential(s) for clique(s): </span></span>
<span><span class="co">## c("dysp", "bronc", "tub", "either"), c("asia", "either", "tub", "dysp") </span></span>
<span><span class="co">##   ... consider using the smooth argument</span></span></code></pre>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bn1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain-main.html">grain</a></span><span class="op">(</span><span class="va">mm1</span><span class="op">$</span><span class="va">modelinfo</span><span class="op">$</span><span class="va">ug</span>, data<span class="op">=</span><span class="va">dat</span>, smooth<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Using bnlearn and hill climbing</span></span>
<span><span class="va">sat_graph</span> <span class="op">&lt;-</span> <span class="fu">bnlearn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/graphgen.html" class="external-link">random.graph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, prob <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># complete graph</span></span>
<span><span class="va">mm2</span> <span class="op">&lt;-</span> <span class="fu">bnlearn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/hc.html" class="external-link">hc</a></span><span class="op">(</span><span class="va">dat</span>, start<span class="op">=</span><span class="va">sat_graph</span><span class="op">)</span></span>
<span><span class="va">bn2</span> <span class="op">&lt;-</span> <span class="fu">bnlearn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/gRain.html" class="external-link">as.grain</a></span><span class="op">(</span><span class="fu">bnlearn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/bn.fit.html" class="external-link">bn.fit</a></span><span class="op">(</span><span class="va">mm2</span>, <span class="va">dat</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>An important detail is that gRim works with decomposable undirected
graphical models (see Figure @ref(fig:bn1)) while bnlearn works with
dags (see Figure @ref(fig:bn2), left). However, even for models
specified as dags, all comptational structures are based on a
corresponding undirected graph (see Figure @ref(fig:bn2), left). For
details, see the references.</p>
<div class="figure">
<img src="figures/grain-bn1-1.png" alt="XXXX." width="480"><p class="caption">
XXXX.
</p>
</div>
<div class="figure">
<img src="figures/grain-bn2-1.png" alt="XXXX." width="480"><p class="caption">
XXXX.
</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="sec:mixture">Extending networks to include other types of variables<a class="anchor" aria-label="anchor" href="#sec:mixture"></a>
</h3>
<p>gRain only handles discrete variables with a finite state space, but
using likelihood evidence it is possible to work with networks with both
discrete and continuous variables (or other types of variables). This is
possible only when he networks have a specific structure. This is
possible when no discrete variable has non–discrete parents.</p>
<p>Take a simple example: Form a network for variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">x=(x_1, x_2)</annotation></semantics></math>.
Conceptually augment this network with additional variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y=(y_1, y_2)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mi>k</mi><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>k</mi></msub><mo>,</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y_1|x_1=k \sim N(\mu_k, v)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mi>k</mi><mo>∼</mo><mi>P</mi><mi>o</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>l</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y_2|x_2=k \sim Poi(l_k)</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">k=1,2</annotation></semantics></math>.
Also we make the assumption that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">y_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">y_2</annotation></semantics></math>
are independent given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">x=(x_1, x_2)</annotation></semantics></math>.
This gives the DAG below:</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">dag</span><span class="op">(</span><span class="op">~</span><span class="va">y1</span><span class="op">:</span><span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span><span class="op">:</span><span class="va">x1</span> <span class="op">+</span> <span class="va">y2</span><span class="op">:</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/grain-unnamed-chunk-53-1.png" width="480"></p>
<p>A network for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
can be constructed as:</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x1<span class="op">=</span><span class="va">yn</span>, x2<span class="op">=</span><span class="va">yn</span><span class="op">)</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt.html">cpt</a></span><span class="op">(</span><span class="op">~</span><span class="va">x1</span>, values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, levels<span class="op">=</span><span class="va">u</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cpt.html">cpt</a></span><span class="op">(</span><span class="op">~</span><span class="va">x2</span><span class="op">|</span><span class="va">x1</span>, values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">7</span><span class="op">)</span>, levels<span class="op">=</span><span class="va">u</span><span class="op">)</span></span>
<span><span class="va">bn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain-main.html">grain</a></span><span class="op">(</span><span class="fu"><a href="../reference/components_gather.html">compile_cpt</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">bn</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       yes     no</span></span>
<span><span class="co">## x1 0.2500 0.7500</span></span>
<span><span class="co">## x2 0.2812 0.7188</span></span></code></pre>
<p>The augmentation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo stretchy="false" form="prefix">|</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">y|x</annotation></semantics></math>
can go along these lines: The parameters describing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo stretchy="false" form="prefix">|</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">y|x</annotation></semantics></math>
are set to be:</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mu1<span class="op">=</span><span class="fl">2</span>, mu2<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda1<span class="op">=</span><span class="fl">1</span>, lambda2<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Suppose we observe
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><msubsup><mi>y</mi><mn>1</mn><mo>*</mo></msubsup></mrow><annotation encoding="application/x-tex">y_1 = y_1^*</annotation></semantics></math>.
Then</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><msubsup><mi>y</mi><mn>1</mn><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>∝</mo><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><msubsup><mi>y</mi><mn>1</mn><mo>*</mo></msubsup><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>L</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  p(x|y_1= y_1^*)\propto p(x_1)p(x_2|x_1) p(y_1=y_1^*|x_1) =  p(x_1)p(x_2|x_1) L_1(x_1)
\end{align}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L_1(x_1)</annotation></semantics></math>
denotes the likelihood. In a network setting this corresponds to
changing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(x_1)</annotation></semantics></math>
as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>←</mo><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>L</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  p(x_1) \leftarrow p(x_1)L_1(x_1)
\end{align}</annotation></semantics></math> and then carry on with
propagation. This can be achieved in different ways.</p>
<p>The likelihood is:</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y1_obs</span> <span class="op">&lt;-</span> <span class="fl">14</span> <span class="co"># Observed value for y1_obs</span></span>
<span><span class="va">lik1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">y1_obs</span>, mean<span class="op">=</span><span class="va">mu</span>, sd<span class="op">=</span><span class="va">s</span><span class="op">)</span></span>
<span><span class="va">lik1</span></span></code></pre></div>
<pre><code><span><span class="co">##       mu1       mu2 </span></span>
<span><span class="co">## 3.038e-09 7.992e-06</span></span></code></pre>
<p>One is by setting the likelihood as evidence. An alternative is to
explicitly modify the CPT which specifies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(x_1)</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">bn</span>, simplify<span class="op">=</span><span class="cn">TRUE</span>, exclude<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       yes     no</span></span>
<span><span class="co">## x1 0.2500 0.7500</span></span>
<span><span class="co">## x2 0.2812 0.7188</span></span></code></pre>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bn1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain_evidence.html">setEvidence</a></span><span class="op">(</span><span class="va">bn</span>, evidence<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x1<span class="op">=</span><span class="va">lik1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">bn1</span>, simplify<span class="op">=</span><span class="cn">TRUE</span>, exclude<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          yes     no</span></span>
<span><span class="co">## x1 0.0001267 0.9999</span></span>
<span><span class="co">## x2 0.1250792 0.8749</span></span></code></pre>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x1_upd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal-grain.html">getgrain</a></span><span class="op">(</span><span class="va">bn</span>, <span class="st">"cptlist"</span><span class="op">)</span><span class="op">$</span><span class="va">x1</span> <span class="op">*</span> <span class="va">lik1</span></span>
<span><span class="va">bn2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/replace-cpt.html">replace_cpt</a></span><span class="op">(</span><span class="va">bn</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x1<span class="op">=</span><span class="va">x1_upd</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/querygrain.html">querygrain</a></span><span class="op">(</span><span class="va">bn2</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">##          yes     no</span></span>
<span><span class="co">## x1 0.0001267 0.9999</span></span>
<span><span class="co">## x2 0.1250792 0.8749</span></span></code></pre>
<p>A final remark: The conditional distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">y_1</annotation></semantics></math>
is normal, but the unconditional distribution is a mixture of normals.
Likewise, the conditional distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">y_2</annotation></semantics></math>
is poisson, but the unconditional distribution is a mixture of two
poisson distributions. Evidence on, say
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">y_1</annotation></semantics></math>
changes the belief in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>2</mn></msub><annotation encoding="application/x-tex">x_2</annotation></semantics></math>
and this in turn changes the distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">y_2</annotation></semantics></math>
(evidence changes the mixture weights.)</p>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="va">xsim_marg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">bn</span>, <span class="va">nsim</span>, seed<span class="op">=</span><span class="fl">2022</span><span class="op">)</span></span>
<span><span class="va">xsim_cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">bn1</span>, <span class="va">nsim</span>, seed<span class="op">=</span><span class="fl">2022</span><span class="op">)</span></span>
<span><span class="va">y2marg</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">nsim</span>, lambda<span class="op">=</span><span class="va">lambda</span><span class="op">[</span><span class="va">xsim_marg</span><span class="op">$</span><span class="va">x2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">y2cond</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">nsim</span>, lambda<span class="op">=</span><span class="va">lambda</span><span class="op">[</span><span class="va">xsim_cond</span><span class="op">$</span><span class="va">x2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">y2marg</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">##    0.00    2.00    4.00    3.88    6.00   16.00</span></span></code></pre>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">y2cond</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">##    0.00    3.00    4.00    4.52    6.00   15.00</span></span></code></pre>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y2marg</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>prob<span class="op">=</span><span class="cn">T</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.4</span><span class="op">)</span>, breaks<span class="op">=</span><span class="fl">20</span>, main<span class="op">=</span><span class="st">"marginal p(y2)"</span><span class="op">)</span></span>
<span><span class="va">y2cond</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>prob<span class="op">=</span><span class="cn">T</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.4</span><span class="op">)</span>, breaks<span class="op">=</span><span class="fl">20</span>, main<span class="op">=</span><span class="st">"conditional p(y2|y1*)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/grain-unnamed-chunk-58-1.png" width="480"></p>
</div>
<div class="section level3">
<h3 id="sec:brute-force-comp">Brute force computations and why they fail<a class="anchor" aria-label="anchor" href="#sec:brute-force-comp"></a>
</h3>
<p>The gRain package makes computations as those outlined above in a
very efficient way; please see the references. However, it is in this
small example also possible to make the computations directly: We can
construct the joint distribution (an array with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>8</mn></msup><mo>=</mo><mn>256</mn></mrow><annotation encoding="application/x-tex">2^8=256</annotation></semantics></math>
entries) directly as:</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">joint</span> <span class="op">&lt;-</span> <span class="fu">tabProd</span><span class="op">(</span><span class="va">chest_cpt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">joint</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2 2 2 2 2 2 2 2</span></span></code></pre>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">joint</span>  <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">as.data.frame.table</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   smoke xray asia lung tub dysp bronc either      Freq</span></span>
<span><span class="co">## 1   yes  yes  yes  yes yes  yes   yes    yes 1.323e-05</span></span>
<span><span class="co">## 2    no  yes  yes  yes yes  yes   yes    yes 6.615e-07</span></span>
<span><span class="co">## 3   yes   no  yes  yes yes  yes   yes    yes 2.700e-07</span></span>
<span><span class="co">## 4    no   no  yes  yes yes  yes   yes    yes 1.350e-08</span></span>
<span><span class="co">## 5   yes  yes   no  yes yes  yes   yes    yes 2.620e-04</span></span>
<span><span class="co">## 6    no  yes   no  yes yes  yes   yes    yes 1.310e-05</span></span></code></pre>
<p>This will clearly fail even moderate size problems: For example, a
model with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>80</mn><annotation encoding="application/x-tex">80</annotation></semantics></math>
nodes each with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>10</mn><annotation encoding="application/x-tex">10</annotation></semantics></math>
levels will give a joint state space with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>10</mn><mn>80</mn></msup><annotation encoding="application/x-tex">10^{80}</annotation></semantics></math>
states; that is about the number of atoms in the universe. Similarly,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>265</mn><annotation encoding="application/x-tex">265</annotation></semantics></math>
binary variables will result in a joint state space of about the same
size. Yet, gRain has been used successfully in models with tens of
thousand variables. The ``trick’’ in gRain is to make all computations
without ever forming the joint distribution.</p>
<p>However, we can do all the computations by brute force methods as we
will illustrate here:</p>
<p>Marginal distributions are</p>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tabMarg</span><span class="op">(</span><span class="va">joint</span>, <span class="st">"lung"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## lung</span></span>
<span><span class="co">##   yes    no </span></span>
<span><span class="co">## 0.055 0.945</span></span></code></pre>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tabMarg</span><span class="op">(</span><span class="va">joint</span>, <span class="st">"bronc"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## bronc</span></span>
<span><span class="co">##  yes   no </span></span>
<span><span class="co">## 0.45 0.55</span></span></code></pre>
<p>Conditioning on evidence can be done in different ways: The
conditional density is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>6</mn><annotation encoding="application/x-tex">6</annotation></semantics></math>–way
slice of the original
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>8</mn><annotation encoding="application/x-tex">8</annotation></semantics></math>–way
joint distribution:</p>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">asia_dysp</span></span></code></pre></div>
<pre><code><span><span class="co">## $asia</span></span>
<span><span class="co">## [1] "yes"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $dysp</span></span>
<span><span class="co">## [1] "yes"</span></span></code></pre>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cond1</span> <span class="op">&lt;-</span> <span class="fu">tabSlice</span><span class="op">(</span><span class="va">joint</span>, slice<span class="op">=</span><span class="va">asia_dysp</span><span class="op">)</span></span>
<span><span class="va">cond1</span> <span class="op">&lt;-</span> <span class="va">cond1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cond1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">cond1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2 2 2 2 2 2</span></span></code></pre>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tabMarg</span><span class="op">(</span><span class="va">cond1</span>, <span class="st">"lung"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## lung</span></span>
<span><span class="co">##     yes      no </span></span>
<span><span class="co">## 0.09953 0.90047</span></span></code></pre>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tabMarg</span><span class="op">(</span><span class="va">cond1</span>, <span class="st">"bronc"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## bronc</span></span>
<span><span class="co">##    yes     no </span></span>
<span><span class="co">## 0.8114 0.1886</span></span></code></pre>
<p>Alternatively, multiply all entries not consistent by zero and all
other entries by one and then marginalize:</p>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cond2</span> <span class="op">&lt;-</span> <span class="fu">tabSliceMult</span><span class="op">(</span><span class="va">joint</span>, slice<span class="op">=</span><span class="va">asia_dysp</span><span class="op">)</span></span>
<span><span class="va">cond2</span> <span class="op">&lt;-</span> <span class="va">cond2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cond2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">cond2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2 2 2 2 2 2 2 2</span></span></code></pre>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tabMarg</span><span class="op">(</span><span class="va">cond2</span>, <span class="st">"lung"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## lung</span></span>
<span><span class="co">##     yes      no </span></span>
<span><span class="co">## 0.09953 0.90047</span></span></code></pre>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tabMarg</span><span class="op">(</span><span class="va">cond2</span>, <span class="st">"bronc"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## bronc</span></span>
<span><span class="co">##    yes     no </span></span>
<span><span class="co">## 0.8114 0.1886</span></span></code></pre>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-hoj:12" class="csl-entry">
Højsgaard, Søren. 2012. <span>“Graphical Independence Networks with the
<span class="nocase">gRain</span> Package for <span>R</span>.”</span>
<em>Journal of Statistical Software</em> 46 (10): 1–26. <a href="http://www.jstatsoft.org/v46/i10/" class="external-link">http://www.jstatsoft.org/v46/i10/</a>.
</div>
<div id="ref-hoj:edw:lau:12" class="csl-entry">
Højsgaard, Søren, David Edwards, and Steffen L. Lauritzen. 2012.
<em>Graphical Models with r</em>. Springer.
</div>
<div id="ref-lau/spieg:88" class="csl-entry">
Lauritzen, Steffen L., and David Spiegelhalter. 1988. <span>“Local
Computations with Probabilities on Graphical Structures and Their
Application to Expert Systems.”</span> <em>J. Roy. Stat. Soc. Ser.
B</em> 50 (2): 157–224.
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Søren Højsgaard.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
